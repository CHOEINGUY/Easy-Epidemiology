# DataInputVirtualScroll 개발 현황 및 계획

## 1. 개요
이 문서는 `DataInputVirtualScroll` 컴포넌트의 현재 개발 상태를 요약하고, 기존 `DataInputRefactor` 컴포넌트와의 기능 차이를 분석하여 향후 개발 로드맵과 우선순위를 명확히 하는 것을 목표로 합니다.

---

## 2. 현재까지 구현된 기능
가상 스크롤 버전은 대용량 데이터 처리 성능에 초점을 맞춰 핵심 기능들이 우선적으로 구현되었습니다.

- **✅ 가상 스크롤 엔진 (`useVirtualScroll.js`)**
  - 대량의 행(Row) 데이터를 효율적으로 렌더링하여 DOM 요소를 최소화하고 성능을 확보합니다.
  - 스크롤 위치에 따라 필요한 부분만 동적으로 렌더링합니다.

- **✅ 기본 그리드 UI 구조**
  - `VirtualGridHeader`, `VirtualGridBody` 컴포넌트를 통한 헤더/바디 분리 렌더링
  - 수평 스크롤 시 헤더와 바디 동기화

- **✅ 경량화된 선택 시스템 (`virtualSelectionSystem.js`)**
  - **단일 셀/행 선택**: 마우스 클릭으로 특정 셀 또는 행 전체를 선택합니다.
  - **범위 선택**: 마우스 드래그를 통해 사각형 영역의 셀들을 선택합니다.
  - **키보드 확장 선택**: `Shift` 키와 화살표 키를 조합하여 선택 영역을 확장합니다.

- **✅ 핵심 편집 기능**
  - **인라인 편집**: 셀의 `contenteditable` 속성을 이용한 직접 편집.
  - **편집 모드 진입**:
    - `F2` 키 입력
    - 더블클릭
    - 셀 선택 후 키보드 타이핑 시 즉시 편집 모드로 전환 (`handleTypeToEdit`)
  - **편집 완료/취소**:
    - `Enter`, `Tab`: 변경사항 저장 후 다음 셀로 이동
    - `Escape`: 변경사항을 취소하고 원래 값으로 복원

- **✅ 키보드 네비게이션 (`virtualKeyboardHandlers.js`)**
  - **기본 이동**: `ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`, `Enter`, `Tab` 키를 이용한 셀 간 이동.
  - **고속 이동**: `Ctrl` + 화살표 키로 데이터의 끝/시작으로 빠르게 이동.
  - **헤더-바디 간 이동**: 화살표 키로 헤더와 바디 영역을 넘나드는 네비게이션.
  - **스크롤 동기화**: 키보드 이동 시 선택된 셀이 화면에 보이도록 자동 스크롤(`ensureCellIsVisible`).

- **✅ 동적 컬럼 렌더링**
  - Vuex 상태(`isIndividualExposureColumnVisible`)에 따라 '의심원 노출시간' 컬럼을 조건부로 표시합니다.

---

## 3. `DataInputRefactor` 대비 미구현 기능
기존 버전의 주요 기능들이 아직 새로운 가상 스크롤 버전에 이식되지 않았습니다.

- **🚫 기능 바 (Function Bar)**
  - **버튼 기능 부재**: '데이터 가져오기', '양식 다운로드', '데이터 내보내기', '전체 복사', '빈 열 삭제', '전체 초기화' 등 모든 버튼이 현재는 UI만 구현된 상태입니다.
  - **개별 노출시간 토글**: 버튼은 있으나, 클릭 시 실제 Vuex 상태를 변경하고 컬럼을 토글하는 로직이 연결되지 않았습니다.
  - **선택 셀 정보 연동**: 상단의 셀 주소(`A1`) 및 값 입력창이 실제 선택된 셀 정보와 연동되지 않습니다.

- **🚫 컨텍스트 메뉴 (우클릭 메뉴)**
  - **메뉴 기능 전체 부재**: `DataInputRefactor/parts/ContextMenu.vue`에 구현된 우클릭 메뉴가 없습니다.
  - **핵심 편집 기능 누락**: 이로 인해 **행/열 추가 및 삭제** 기능이 현재 완전히 부재합니다.

- **✅ Excel 데이터 처리 (완료)**
  - **Excel 가져오기/내보내기**: Web Worker(`excelWorker.js`) 오프로드 + `ExcelUploadButton.vue`/Drag-&-Drop 구현으로 대용량(5k×200+)도 부드럽게 처리.
  - **진행률·컬럼 자동 토글**: 업로드 동안 Function Bar/DragOverlay에 % 표시, '의심원 노출시간' 열 자동 가시화.

- **🚫 행/열 조작 기능**
  - **행 순서 변경**: `rowDragSystem.js` 로직이 없어 연번(Serial) 컬럼을 드래그하여 행의 순서를 변경하는 기능이 없습니다.
  - **열 크기 조절 및 순서 변경**: 헤더를 드래그하여 열의 너비를 조절하거나 순서를 바꾸는 기능이 없습니다.

- **🚫 복사 & 붙여넣기 (Clipboard API)**
  - 단일 셀의 텍스트 복사/붙여넣기는 브라우저 기본 동작으로 가능하지만, **여러 셀 범위를 복사하여 다른 위치에 붙여넣는** 기능(`paste` 이벤트 핸들링)이 없습니다.

- **🚫 데이터 유효성 검사**
  - `AppHeader`에 버튼 UI는 주석 처리되어 있으나, 데이터의 유효성을 검사하고 오류를 사용자에게 알리는 로직이 없습니다.

- **🚫 사용자 피드백**
  - **토스트 메시지**: `ToastContainer.vue` 및 `toast.js` 로직이 없어 작업 완료/실패 등의 피드백을 주는 기능이 없습니다.

---

## 4. 우선순위 및 구현 계획
안정적인 데이터 편집 환경을 먼저 구축하고, 부가 기능을 순차적으로 추가하는 방향으로 진행합니다.

### 🥇 **1순위: 핵심 데이터 조작 기능**
> **목표**: 사용자가 데이터를 입력, 수정, 삭제하는 기본적인 편집 작업을 원활하게 수행할 수 있도록 합니다.

1.  **✅ 컨텍스트 메뉴 구현 및 기능 연결 (완료)**
    -   **세부 작업**:
        -   `ContextMenu.vue` 컴포넌트를 `DataInputVirtualScroll/parts`로 이식.
        -   우클릭 시 메뉴가 나타나도록 `contextMenuHandlers.js` 로직 구현.
        -   **행 추가/삭제, 열 추가/삭제** 액션을 Vuex 스토어와 연동. 가상 스크롤 환경에 맞게 인덱스 계산 주의.
    -   **이유**: 테이블의 구조를 변경하는 가장 핵심적인 기능이며, 데이터 입력에 필수적입니다.

2.  **✅ 기능 바(Function Bar) 상단 입력창 실시간 양방향 연동 (완료)**
    -   **세부 작업**:
        -   셀 선택 시, 해당 셀의 주소와 값을 상단 기능 바의 입력창에 즉시 표시.
        -   기능 바의 입력창에 값을 입력하면, **실시간으로** 선택된 셀의 데이터가 업데이트되도록 구현.
        -   기능 바 입력창에서 `Enter` 키를 누르면, 그리드 내의 다음 셀(아래쪽)로 포커스를 이동시켜 연속적인 데이터 입력을 지원.
    -   **이유**: Excel과 유사한 사용 경험을 제공하며, 복잡한 데이터를 입력/수정할 때 편의성을 크게 향상시킵니다.
    -   **구현 결과**:
        1.  **데이터 하향식 연동 (셀 선택 -> 기능 바)**: `DataInputVirtual.vue`에서 선택된 셀 정보(`selectedCellInfo`)를 `computed`로 계산하여 `VirtualFunctionBar`에 `props`로 전달.
        2.  **데이터 상향식 실시간 연동 (기능 바 입력 -> 셀 업데이트)**: `VirtualFunctionBar`의 `input` 이벤트 발생 시, 변경된 값을 `emit('update-cell-value')`하여 `DataInputVirtual.vue`가 이를 받아 실시간으로 Vuex 스토어를 업데이트.
        3.  **Enter 키 네비게이션**: `VirtualFunctionBar`에서 `@keydown.enter` 이벤트 발생 시 `emit('enter-pressed')`를 호출. `DataInputVirtual.vue`는 이를 받아 다음 셀로 선택을 이동시키는 로직을 수행.

3.  **✅ 범위 복사 & 붙여넣기 구현 (완료)**
    -   **세부 작업**:
        -   **키보드 이벤트 리스너 확장**: `virtualKeyboardHandlers.js`의 `handleVirtualKeyDown` 함수를 확장하여 `Ctrl+C` (복사) 및 `Ctrl+V` (붙여넣기) 단축키를 처리합니다.
        -   **Copy 로직 (`handleCopy`)**: `Ctrl+C` 입력 시, `selectionSystem`에서 현재 선택된 범위의 셀 데이터를 가져옵니다. 이 데이터를 탭으로 구분된 텍스트(TSV) 형식으로 변환하여 `navigator.clipboard.writeText()` API를 통해 클립보드에 저장합니다.
        -   **Paste 로직 (`handlePaste`)**: `Ctrl+V` 입력 시, `navigator.clipboard.readText()` API를 사용하여 클립보드에서 텍스트를 읽어옵니다. 탭과 줄바꿈을 기준으로 텍스트를 파싱하여 2차원 데이터 배열로 변환합니다.
        -   **Vuex 액션 추가**: 스토어에 `pasteData` 액션을 새로 정의합니다. 이 액션은 붙여넣기를 시작할 셀의 위치(`rowIndex`, `colIndex`)와 파싱된 2차원 데이터를 인자로 받아, 그리드 범위를 벗어나지 않도록 주의하며 여러 셀의 데이터를 한 번에 업데이트합니다.
        -   **UX 개선**: 붙여넣기 작업이 완료된 후, 붙여넣기된 데이터 영역이 새로운 선택 범위로 지정되도록 합니다.
    -   **이유**: 반복적인 데이터 입력을 획기적으로 줄여주고, Excel 등 외부 소스와의 데이터 연동성을 확보하는 필수 기능입니다.

4.  **✅ Ctrl 다중선택 컨텍스트 메뉴 일괄처리 (완료)**
    -   **세부 작업**:
        -   **개별 선택 인식**: 컨텍스트 메뉴가 Ctrl+Click으로 선택된 행/셀들을 정확히 인식하도록 `contextMenuHandlers.js` 및 `virtualCellHandlers.js` 수정.
        -   **메뉴 아이템 개수 표시**: 선택된 행/열 개수를 메뉴 텍스트에 표시 ("행 삭제 (3개)" 등).
        -   **일괄 처리 로직**: 개별 선택된 여러 행/열에 대한 삭제, 데이터 삭제, 삽입 기능을 `DataInputVirtual.vue`에 구현.
        -   **선택 상태 보존**: 우클릭 시 기존 개별 선택 상태를 유지하고, 작업 완료 후 자동 초기화.
    -   **이유**: 대용량 데이터에서 비연속적인 행/열을 효율적으로 관리할 수 있는 핵심 기능입니다.

### 🥈 **2순위: 사용자 피드백 시스템 구현**
> **목표**: 주요 작업에 대한 명확한 피드백을 제공하여 사용자 경험을 개선합니다.

1. **✅ 토스트 메시지 시스템 구현** (완료)
   - **대상 기능**:
     - **전체 데이터 복사**: 복사 완료 시 "전체 데이터가 클립보드에 복사되었습니다" 토스트 표시
     - **빈 열 삭제**: 삭제 완료 시 "빈 열 X개가 삭제되었습니다" 토스트 표시
     - **전체 초기화**: 확인 다이얼로그 → 진행 → "데이터가 초기화되었습니다" 토스트 표시
   
       - **구현 완료**:
      1. **✅ ToastContainer.vue 컴포넌트**: 화면 우상단에 토스트 메시지 표시, 슬라이드 인/아웃 애니메이션
      2. **✅ toast.js 유틸리티**: 토스트 메시지 관리 로직 (성공/경고/에러 타입 지원), 최대 3개 동시 표시
      3. **✅ 확인 다이얼로그 시스템**: `showConfirmToast`로 전체 초기화 시 확인 다이얼로그 표시
      4. **✅ Function Bar 버튼 연동**: 전체 복사, 빈 열 삭제, 전체 초기화 버튼에 토스트 메시지 연동
   
   - **토스트 메시지 사양**:
     - **위치**: 화면 우상단 고정
     - **지속시간**: 3초 (성공), 5초 (에러)
     - **애니메이션**: 슬라이드 인/아웃 효과
     - **타입별 색상**: 성공(녹색), 경고(주황), 에러(빨강)
     - **최대 개수**: 동시에 3개까지 표시, 오래된 것부터 자동 제거
   
   - **제외 기능**: 
     - Excel 가져오기/내보내기 (이미 진행률 표시 존재)
     - 컨텍스트 메뉴 액션 (즉시 시각적 피드백 제공)
           - 개별 노출시간 토글 (UI 상태 변화로 충분)

### 🥉 **3순위: 데이터 입출력 및 편의 기능**
> **목표**: 외부 데이터를 활용하고, 대량의 데이터를 쉽게 관리할 수 있도록 합니다.

1.  **✅ Excel 데이터 가져오기/내보내기 (완료)**
    -   **세부 작업**:
        -   `ExcelUploadButton.vue`, `excelProcessor.js`, `useDataExport.js` 로직 이식.
        -   기능 바의 '데이터 가져오기', '내보내기', '양식 다운로드' 버튼에 각각의 기능 연결.
    -   **개선 및 리팩터링 (퍼포먼스/UX)**:
        -   **메모리 최적화**: `excelProcessor` 파싱을 스트리밍 방식(`XLSX.stream`)이나 `xlsx.mini.min.js` 사용으로 변경하여 5000×200+ 셀도 버벅임 없이 처리.
        -   **헤더 검증 로직 단순화**: `validateExcelFormat` 을 완화하고, 누락된 열은 자동 확장·빈 값으로 채우기 옵션 제공.
        -   **열 자동 확장/맵핑**: 가져온 시트 열 수가 헤더보다 많거나 적을 때 `ADD_MULTIPLE_COLUMNS` / `INSERT_MULTIPLE_COLUMNS_AT` 로 동적으로 컬럼을 늘리거나 삽입.
        -   **내보내기 메모리 관리**: `downloadXLSX` 는 `XLSX.utils.sheet_add_aoa` 로 chunk 추가하거나 CSV 스트리밍(`Blob`) 옵션 추가해 대용량도 안정적으로 다운로드.
        -   **Clipboard ↔ Excel 파싱 규칙 통일**: 시작 셀 오프셋 계산 헬퍼를 공유하여 TSV 붙여넣기와 Excel Import 결과가 일관되도록 유지.
        -   **Import 후 포커스/스크롤 초기화**: 대량 행 삽입 뒤 `selectionSystem.selectCell(0,0)` 및 `ensureCellIsVisible(0,0)` 호출로 사용자 시야 보장.
    -   **이유**: 다른 도구와의 데이터 연동성을 확보하고, 초기 데이터 세팅 및 결과물 공유를 위해 반드시 필요합니다.

### 🎯 **4순위: 행/열 드래그 앤 드롭 시스템**
> **목표**: Excel과 같은 직관적인 행/열 조작 기능을 제공합니다.

1. **행 순서 변경 (Row Drag & Drop)**
   - **구현 대상**: 연번(Serial) 컬럼을 드래그하여 행의 순서를 변경
   - **기술 요구사항**: 
     - 드래그 시작: 연번 셀에서 mousedown 감지
     - 드래그 중: 드롭 가능한 위치에 시각적 인디케이터 표시
     - 드롭 완료: Vuex 액션으로 행 순서 재배열
   - **난이도**: ★★★ (가상 스크롤과의 호환성 고려 필요)

2. **열 크기 조절 (Column Resize)**
   - **구현 대상**: 헤더 경계선을 드래그하여 열 너비 동적 조절
   - **기술 요구사항**:
     - 헤더 경계선에 resize cursor 표시
     - 드래그 시 실시간 너비 변경 미리보기
     - `allColumnsMeta` 상태에 변경된 너비 반영
   - **난이도**: ★★

3. **열 순서 변경 (Column Drag & Drop)**
   - **구현 대상**: 헤더를 드래그하여 열 순서 변경
   - **기술 요구사항**:
     - 그룹 내에서만 순서 변경 허용
     - 드래그 중 드롭 위치 시각적 표시
     - Vuex 액션으로 열 순서 재배열
   - **난이도**: ★★★

### 🎯 **5순위: 고급 기능**
> **목표**: 전문적인 데이터 분석을 위한 고급 기능을 제공합니다.

1. **데이터 유효성 검사**
   - 입력 규칙 정의 및 실시간 검증
   - 오류 셀 시각적 표시
   - 유효성 검사 결과 요약 패널

2. **고급 키보드 네비게이션 (Ctrl/Shift 조합)**
   - Ctrl+Shift+Arrow: 고속 범위 선택
   - 데이터 블록 단위 네비게이션
   - 1만 행 대용량 데이터에서 50ms 이내 응답

---

## 5. 2025-06-28 기능 업데이트

### 🆕 Function Bar 툴팁 시스템 구현
1. 모든 상단 버튼(개별 노출시간, 데이터 가져오기, 양식 다운로드, 데이터 내보내기, 전체 복사, 빈 열 삭제, 전체 초기화)에 Refactor 버전과 동일한 전역 툴팁 UX 이식.
   • Teleport + edge 보정 + fade-in 효과.
   • 템플릿 버튼은 Hover 시 즉시 드롭다운을 노출하고 툴팁은 비활성화.
2. 초기 깜박임 현상 제거를 위해 nextTick 후 `opacity` 전환 방식 사용.

### 🆕 Cell-ID(현재 셀 주소) 표시 개선
1. 선택된 셀의 정보가 아래 형식으로 표시되도록 로직 수정.
   • 일반 셀   → `[그룹명] / [행번호]`  (예: `임상증상 / 10`)
   • 헤더 셀  → `[그룹명]` 또는 `환자여부` 고정 값.
   • 연번(행 전체) 선택 시 주소 공백.
2. 그룹 열(기본정보·임상증상·식단)은 **편집 여부와 관계없이** 항상 그룹명을 사용.
3. 환자여부 열은 고정 라벨 "환자여부" 사용.

### 🆕 Ctrl 다중선택 컨텍스트 메뉴 일괄처리 (2025-06-28)
1. **개별 선택 인식**: 컨텍스트 메뉴가 Ctrl+Click으로 선택된 행/셀들을 정확히 인식하도록 개선.
   • `contextMenuHandlers.js`: 개별 선택 상태(`selectedRowsIndividual`, `selectedCellsIndividual`) 고려한 메뉴 생성.
   • `virtualCellHandlers.js`: 우클릭 시 개별 선택 상태 보존 로직 추가.
2. **메뉴 아이템 개수 표시**: "행 삭제 (3개)", "열 데이터 삭제 (2개)" 등 선택된 개수를 메뉴에 표시.
3. **일괄 처리 액션**: 
   • **행 삭제/데이터 삭제**: 개별 선택된 여러 행들을 한번에 처리 (역순 삭제로 인덱스 변화 방지).
   • **열 삭제/데이터 삭제**: 개별 선택된 여러 열들을 한번에 처리 (최소 1개 열 유지 규칙 적용).
   • **행/열 삽입**: 선택된 개수만큼 행/열 삽입.
4. **선택 상태 관리**: 작업 완료 후 개별 선택 상태 자동 초기화.

### 🆕 토스트 메시지 시스템 구현 (2025-06-28)
1. **토스트 컨테이너**: 화면 우상단에 최대 3개까지 토스트 메시지 표시, 슬라이드 인/아웃 애니메이션.
2. **확인 다이얼로그**: `showConfirmToast`를 통한 전체 초기화 시 사용자 확인 절차.
3. **Function Bar 연동**: 
   • **전체 데이터 복사**: 성공/실패 토스트 표시
   • **빈 열 삭제**: 삭제된 열 개수와 함께 결과 토스트 표시
   • **전체 초기화**: 확인 다이얼로그 → 진행 → 완료 토스트
4. **타입별 스타일링**: 성공(녹색), 에러(빨강), 정보(파랑) 색상으로 구분.

### 🆕 개별 노출시간 버튼 활성화 상태 표시 (2025-06-28)
1. **활성화 상태 인식**: Vuex 상태 `isIndividualExposureColumnVisible`을 통해 컬럼 가시성 감지.
2. **조건부 CSS 클래스**: 컬럼이 표시된 상태일 때 버튼에 `active` 클래스 적용.
3. **시각적 피드백**: 활성화 시 파란색 배경(`#e8f0fe`)과 진한 파란색 텍스트(`#1967d2`)로 표시.
4. **아이콘 색상 변경**: 활성화 상태에서 아이콘도 동일한 파란색으로 변경하여 일관성 유지.

> 이제 가상 스크롤 버전의 Function Bar 사용 경험이 Refactor 버전과 동일해졌으며, 툴팁 및 셀 주소 정보가 정확히 표시됩니다. 또한 Ctrl 다중선택 후 컨텍스트 메뉴를 통한 일괄 처리가 완벽하게 작동하고, 주요 작업에 대한 사용자 피드백이 토스트 메시지로 제공됩니다. 

## 6. 2025-06-29 기능 업데이트

### 🆕 Cell-ID 표시 로직 추가 개선

1. **그룹 열 개별 변수명 표시**
   • 임상증상·식단 등 *그룹 열*에 속한 **바디 셀**을 선택하면, 기존 그룹명이 아닌 **해당 변수명**(예: `chill`, `nausea`)이 그대로 표시되도록 수정.
   • 헤더 셀 선택 시에는 이전과 동일하게 그룹명이 표시됩니다.

2. **환자여부 열 설명 문구 제거**
   • `환자여부 (환자 - 1, 정상 - 0)` 헤더 하위의 셀을 선택했을 때 Cell-ID에 괄호 안 설명이 포함되지 않도록 개선.
   • 이제 항상 **`환자여부`**만 노출됩니다.

> 이번 패치로 Cell-ID가 더욱 직관적으로 표시되어, 데이터 위치 파악이 쉬워졌습니다. 

## 7. 열 추가/삭제 버튼 구현 로드맵 (예정)

### 배경
• 구버전(`DataInputRefactor`)의 `GridHeader.vue`에는 그룹 헤더(기본정보‧임상증상‧식단)에 **+ / –** 버튼이 포함되어 있어 동적으로 열을 추가·삭제할 수 있음. <br/>
• 가상 스크롤 버전(`DataInputVirtualScroll`)에서는 UI-만 존재하고 기능은 아직 연결되지 않음.

### 목표
1. 그룹 헤더 우측 상단에 **열 추가(+)** / **열 삭제(–)** 버튼을 표시.  
2. 버튼 클릭 시 Vuex 스토어 액션(`insertMultipleColumnsAt`, `deleteMultipleColumnsByIndex`)을 호출하여 실시간으로 열 구조를 변경.  
3. "최소 1개 열 유지" 규칙을 적용하여 삭제 불가 상태에서는 – 버튼 disabled 처리.  

### 세부 작업
| 단계 | 내용 | 파일 | 비고 |
|-----|------|------|------|
| 1 | 구버전 `GridHeader.vue` 의 버튼 렌더링 및 툴팁 로직 이식 | `layout/VirtualGridHeader.vue` | 이미 마크업 존재 → 이벤트 연결만 필요 |
| 2 | `VirtualGridHeader.vue` 에 `@click.stop` 핸들러 추가 → `emit('add-column', group.type)` / `'delete-column'` | `layout/VirtualGridHeader.vue` | 구버전과 동일 이벤트 네이밍 유지 |
| 3 | 상위 컴포넌트 `DataInputVirtual.vue` 에서 이벤트 수신 후 Vuex 액션 호출 | `DataInputVirtual.vue` | `insertMultipleColumnsAt` / `deleteMultipleColumnsByIndex` 재사용 |
| 4 | 삭제 버튼 disabled 조건 계산 (그룹 열이 1개 이하) | `VirtualGridHeader.vue` | `group.deletable && group.columnCount > 1` |
| 5 | 열 추가 후 포커스·선택 영역 갱신 (신규 열 첫 셀 선택) | `DataInputVirtual.vue` | `selectionSystem.selectCell(anchorRow, newColIdx)` |


### 위험 요소 & 대응
1. **가상 스크롤 오프셋 계산 오류** → 열 meta 재계산 로직(`allColumnsMeta`)는 reactive이므로 `watch`-trigger로 즉시 반영되는지 확인.  
2. **헤더–바디 동기 스크롤** → 열 개수 변경 시 `tableWidth` 변경으로 CSS reflow 발생; 퍼포먼스 테스트 필요.  
3. **Undo/Redo** → 현재는 미구현. 추후 history 스택 추가 검토.

### 예상 일정
• 2025-06-30  : 기본 기능(+ / – 버튼, 스토어 연동) 완료  
• 2025-07-01  : 단축키 & disabled 상태 처리  
• 2025-07-02  : QA 및 성능 튜닝, 문서화

## 8. 2025-06-29 구현 완료 내역

### ✅ 열 추가/삭제 버튼 + 툴팁 기능 구현

| 완료 항목 | 세부 내용 |
|-----------|-----------|
| 버튼 위치 · 스타일 | `VirtualGridHeader.vue`의 `.header-actions`를 `position:absolute`로 변경하여 그룹 헤더 왼쪽 중앙에 고정하고, 구버전과 동일한 크기·hover·active 효과를 적용함 |
| 기능 연동 | + 버튼 → `insertMultipleColumnsAt`, – 버튼 → `deleteMultipleColumnsByIndex` 호출. "최소 1개 열 유지" 규칙 적용 |
| 선택 상태 초기화 | 열 추가·삭제 후 `selectionSystem.clearSelection()` 및 그리드 포커스 유지 |
| 툴팁 UX | 버튼 hover 시 "열을 추가합니다" / "열을 삭제합니다" 혹은 삭제 불가 안내 툴팁 표시. `Teleport`를 사용해 body 레이어에 렌더링하며 fade-in 애니메이션 구현 |

> 앞으로 단축키(Ctrl+Shift+±)와 Undo/Redo 기능을 보강할 예정입니다.

## 9. 2025-06-30 기능 개선

### 🆕 연번(Serial) 셀 Shift 범위 선택 지원

기존에는 연번 열에서 **Shift 클릭**으로 연속 행 범위 선택이 되지 않아, 다중 행 선택을 위해서는 Ctrl+Shift 조합이나 드래그만 사용해야 했습니다. 이제 다음과 같이 개선되었습니다.

1. **행 범위 선택 플로우**
   • 기준(Anchor) 행을 클릭해 선택 → Shift 를 누른 상태에서 다른 연번 셀 클릭 → 두 행 사이의 모든 행이 선택됩니다.  
   • 선택 결과는 `selectionSystem.selectRowRange()`를 호출해 개별 행 집합(`selectedRowsIndividual`)로 관리되어 컨텍스트 메뉴 등과 완전 호환됩니다.

2. **구현 요약**
   • `handlers/virtualCellHandlers.js`의 Shift 처리 분기에서, `colIndex === 0` 조건일 때 `selectRowRange(anchor, target)` 호출하도록 로직 추가.  
   • 기존 셀 범위 확장(`extendSelection`)은 일반 셀에만 적용.

3. **UX 효과**
   • Excel 과 동일한 Shift+클릭 행 범위 선택 경험 제공.  
   • 컨텍스트 메뉴 "행 삭제 (n개)" 등 일괄 작업이 더욱 편리해짐.

## 10. 2025-06-30 행 추가·빈 행 삭제 컨트롤 구현

### ✅ 하단 '행 추가 / 빈 행 삭제' 컨트롤 이식

| UI 요소 | 동작 |
|----------|-------|
| 숫자 입력 (+ Enter) | 입력한 개수의 행을 시트 하단에 추가 (`insertRowAt` 호출) |
| '빈 행 삭제' 버튼 | 모든 빈 행 제거 (`deleteEmptyRows` 호출) |

세부 내용
1. **컴포넌트**: `parts/AddRowsControls.vue` – 마크업·스타일 구버전 그대로 복사.<br/>
2. **DataInputVirtual.vue 연결**  
   • 이벤트 수신 `onAddRows`, `onDeleteEmptyRows` 구현.<br/>
   • 행 추가 후 첫 추가 행으로 포커스 이동, 토스트 메시지 출력.<br/>
3. **스타일**: Function Bar 아래 고정 위치(`border-top` 배경 `#f8f9fa`)로 UX 통일.